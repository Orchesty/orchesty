version: '2'
services:
  rabbitmq:
    image: 'rabbitmq:management-alpine'
  redis:
    image: 'redis:alpine'
  influxdb:
    image: 'influxdb:latest'
  mongo:
    image: 'mongo:3.4'
  # logstash dummy (tests fail on nonexistent hostname)
  logstash:
    image: busybox

  test:
      image: dkr.hanaboso.net/pipes/pipes/pf-bridge:dev
      environment:
        - RABBITMQ_HOST=rabbitmq
        - REDIS_HOST=redis
        - METRICS_HOST=influxdb
        - METRICS_PORT=8086
      depends_on:
        - rabbitmq
        - redis
        - mongo
      command: sleep infinity
