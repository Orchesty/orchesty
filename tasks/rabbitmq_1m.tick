dbrp "pipes"."5s"

var sample = 1m
var retention = '1m'

batch
   |query('SELECT mean("avg.message") as "avg.message", max("max.message") as "max.message" FROM "pipes"."5s"."rabbitmq"')
       .period(sample)
       .every(sample)
       .groupBy('topology_id', 'node_id')
   |influxDBOut()
       .database('pipes')
       .measurement('rabbitmq')
       .precision('ms')
       .retentionPolicy(retention)